<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>판매 정보 검색</title>
<script th:src="@{/js/jquery-3.6.0.js}"></script>

<script>
	$(document).ready(function()
	{
		searchAll();
		$('#category').click(search);
		$('#keyword').keyup(search);
	});
	
	function searchAll()
	{
		$.ajax({
			
			url:'searchAll',
			type:'get',
			dataType: 'json',
			
			success: function(list)
			{
				let table = `<table>
								<tr>
									<td>번호</td>
									<td>카테고리</td>
									<td>제목</td>
								</tr>`;
				$(list).each(function(index,item)
				{
					table +=`<tr>
								<td>${item.boardnum}</td>
								<td>${item.category}</td>
								<td>${item.title}</td>
							</tr>`;
				});
				
				table += '</table>';
				$('#output').html(table);
			},
			error: function()
			{
				alert('실행실패')
			}
		});	
	};
	
	
	function search()
	{
		let category = $('#category').val();
		let keyword = $('#keyword').val();
		
		$.ajax({
			
			url:'search',
			type:'get',
			data: {category: category, keyword: keyword},
			dataType: 'json',
			
			success: function(list)
			{
				let table = `<table>
								<tr>
									<td>번호</td>
									<td>카테고리</td>
									<td>제목</td>
								</tr>`;
				$(list).each(function(index,item)
				{
					table +=`<tr>
								<td>${item.boardnum}</td>
								<td>${item.category}</td>
								<td>${item.title}</td>
							</tr>`;
				});
				
				table += '</table>';
				$('#output').html(table);
			},
			error: function()
			{
				alert('실행실패')
			}
		});	
	};
	

</script>

</head>
<body>

	<h1>[ 판매 정보 검색 ]</h1>
	<span><a th:href="@{/}">메인 화면</a></span>
	<br>
		<select name="category" id="category">
		  <option value="all" selected="selected">전체</option>
		  <option value="computer">컴퓨터</option>
		  <option value="phone">핸드폰</option>
		  <option value="notbook">노트북</option>
		</select>
		<input type="text" name="keyword" id="keyword">
		
		<div id="output"></div>
		
		
</body>
</html>